<html>
    <head>
        <link rel="stylesheet" href="unbxdAutosuggest.css">
        <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0/handlebars.min.js"></script>
        <script src="//code.jquery.com/jquery-1.10.2.js"></script>
        <script src="unbxdAutosuggest.js"></script>
        <style>
            #autoSuggestResults {
                position: relative;
            }
            #unbxdInput {
                width: 100%;
                height: 50px;
            }
        </style>
    </head>
    <body>
        <div id="autoSuggestResults">
        <input type="text" id="unbxdInput" />
        </div>
    </body>
    <script>
            const renderAutosuggest = function () {
        window.unbxdAutoSuggestFunction($, Handlebars);
        $("#unbxdInput").unbxdautocomplete({
                // siteName: "ss-unbxd-prod-taw9eel-eng41461681305976"
                // , APIKey: "6052267452702bf2373fb05cd1e1fd0a"
                // (infield suggestions, trending queries from below set)
                siteName: "sanity-com-au807721559915031"
                , APIKey: "5c3a4f2cbd061731cf6fa614437bc8eb"
                // (promoted suggestions from below set)
                // siteName: "ss-unbxd-prod-ryda-magento45401691393346"
                // , APIKey: "bbc7050687a61386ec6fdcc0c4a245c9" 
                , minChars: 1
                , showCarts: false
                , position: "relative"
                , integrations: {
                'universal': true
                }
                , template: (window.UNBXD_AUTO_CONFIG && window.UNBXD_AUTO_CONFIG.template) || "2column"
                , mainTpl: (window.UNBXD_AUTO_CONFIG && window.UNBXD_AUTO_CONFIG.mainTpl) || ['inFields', 'keywordSuggestions', 'topQueries', 'promotedSuggestions']
                , sideTpl: ['popularProducts']
                , sideContentOn: (window.UNBXD_AUTO_CONFIG && window.UNBXD_AUTO_CONFIG.sideContentOn) || "right"
                , cartType: "separate"
                , noResultTpl: "No results found."

                , onItemSelect: function (data) {
                // if (data.type === "IN_FIELD" && data.filtername) {
                //     if (data.filtername) {
                //     window.location = window.location.origin + window.location.pathname + "?&q=" + encodeURIComponent(data.value) + "&filter=" + data.filtername + "_uFilter:" + encodeURIComponent('"' + data.filtervalue + '"');
                //     } else {
                //     window.location = window.location.origin + window.location.pathname + "?&q=" + encodeURIComponent(data.value);
                //     }
                // } else {
                //     window.location = window.location.origin + window.location.pathname + "?&q=" + encodeURIComponent(data.value);
                // }
                }
                , onCartClick: function (obj) {
                return true;
                }
                , isMobile: function () {
                if (document.body.clientWidth <= 480) {
                    return true;
                } else {
                    return false;
                }
                }
                , theme: "#666666"
                , sortByLength: true
                , inFields: {
                header: '',
                count: 6,
                showDefault: true,
                noOfInfields: 1
                },
                topQueries: {
                count: 2
                , header: ''
                },
                keywordSuggestions: {
                count: 6
                , header: ''
                }
                , popularProducts: {
                count: 6
                , price: true
                , priceFunctionOrKey: "price"
                , image: true
                , imageUrlOrFunction: "imageUrl"
                , currency: "$"
                , header: 'Popular Products'
                , name: true
                , nameFunctionOrKey: "title"
                , view: "grid"
                , rowCount: 3
                // , filteredExtraParams: {
                //     filter: "t9AreaProduct:0",
                // }
                , fields: ["sellingPrice","price","discount","uniqueId","productUrl","title","imageUrl","id","autosuggest","doctype"]
                },
                trendingSearches: {
                    enabled: true,
                    maxCount: 5
                },
                inputContainerSelector: "#unbxdInput",
                preferInputWidthTotalContent: true,
                preferOneColumnFullWidth: true,
                filtered: true,
                
                platform: 'io',
                preferInputWidthMainContent: true,
                hideOnResize: true,
                removeOnBackButton: true,
                
                resultsContainerSelector: "#autoSuggestResults",
                removeDuplicates: false,
                extraParams: {
                    __ts: (new Date()).getTime()
                    // version: "V2",
                    // "popularProducts.filter": "t9AreaProduct:0",
                    // "fallback.method": "fuzzySearch",
                    // "uid": "uid-1690270152946-67188",
                    // "fallback": true
                    // filter: "-content_type:BLOG",
                }
                // processResultsStyles: function(pos){
                //     let counter = 0;
                //     const resultsObj = this.currentResults;
                //     const obArr = Object.keys(resultsObj);
                //     obArr.forEach((item)=> {
                //         if(resultsObj[item].length > 0) {
                //             counter = counter + 1
                //         }
                //     });
                //     const auElem = this.$results[0];
                //     const mainContent = auElem.querySelector(".unbxd-as-maincontent");
                //     if(counter === 1 ) {
                //         auElem.querySelector(".unbxd-as-sidecontent").style.width = "100%";
                //     }
                //     if(counter === 0 && mainContent ) {
                //         mainContent.style.width = "100%";
                //     } 
                //     return {
                //         top: "100%",
                //         left: "0"
                //     }
                // }
        });
    };

    /** Server Command */
    /** python3 -m http.server */




   
   
    renderAutosuggest();
    </script>
</html>

